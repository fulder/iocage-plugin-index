name: Test installing plugins

on: [push]

jobs:

  changed-files:
    runs-on: ubuntu_latest
    name: Get Changed files

    steps:
      - name: checkout
        uses: actions/checkout@v2
        with:
          fetch-depth: 0

     - name: get changed files
       id: getfile
       run: |
         echo "::set-output name=files::$(git diff-tree --no-commit-id --name-only -r ${{ github.sha }}| xargs)"

    - name: echo the changed files
      run: |
        for i in ${{ steps.getfile.outputs.files }}
        do
            echo $i
        done

  test-install:
    runs-on: macos-latest
    name: Test FreeBSD job

    steps:
      - name: Test in FreeBSD
        id: test
        uses: vmactions/freebsd-vm@v0.1.2
        with:
          usesh: true
          prepare: pkg install -y curl
          run: |
            pwd
            ls -lah
            whoami
            env
            freebsd-version